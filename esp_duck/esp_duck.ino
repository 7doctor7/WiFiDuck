/*
   Copyright (c) 2019 Stefan Kremser
   This software is licensed under the MIT License. See the license file for details.
   Source: github.com/spacehuhn/WiFiDuck
 */

#define ENABLE_DEFAULT_DELAY
#define OPEN_NOTEPAD
// #define HELLO_WORLD
// #define DELAY_TEST
// #define REPEAT_TEST
// #define REPEAT_TEST
// #define US_CHAR_TEST
#define DE_CHAR_TEST
// #define OVERFLOW_TEST
// #define CLOSE_NOTEPAD

#include "DuckyTransmitter.h"

DuckyTransmitter duck;

void setup() {
    Serial.begin(115200);
    Serial.println();

    delay(2000);

    duck.begin();

    Serial.println("Started");

    if (duck.connected()) {
        Serial.println("Connected!");

        delay(2000);

#ifdef ENABLE_DEFAULT_DELAY
        duck.sendMessage("DEFAULTDELAY 200\n");
#endif // ifdef ENABLE_DEFAULT_DELAY

#ifdef OPEN_NOTEPAD
        duck.sendMessage("GUI r\n");
        duck.sendMessage("STRING notepad\n");
        duck.sendMessage("ENTER\n");
#endif // ifdef OPEN_NOTEPAD

#ifdef HELLO_WORLD
        duck.sendMessage("STRING Hello World! \n");
        duck.sendMessage("ENTER\n");
#endif // ifdef HELLO_WORLD

#ifdef DELAY_TEST
        duck.sendMessage("DELAY 1000\n");
        duck.sendMessage(".\n");
        duck.sendMessage("DELAY 3000\n");
        duck.sendMessage(".\n");
        duck.sendMessage("DELAY 5000\n");
        duck.sendMessage(".\n");
        duck.sendMessage("ENTER\n");
#endif // ifdef HELLO_WORLD

#ifdef REPEAT_TEST
        duck.sendMessage("STRING Hello World! \n");
        duck.sendMessage("REPEAT 2\n");
#endif // ifdef REPEAT_TEST

#ifdef US_CHAR_TEST
        duck.sendMessage("ENTER\n");
        duck.sendMessage("STRING !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\n");
        duck.sendMessage("ENTER\n");
#endif // ifdef ALL_CHAR_TEST

#ifdef DE_CHAR_TEST
        duck.sendMessage("ENTER\n");
        duck.sendMessage("STRING !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_abcdefghijklmnopqrstuvwxyz{|}~äöüÄÖÜß€` \n");
        duck.sendMessage("ENTER\n");
#endif // ifdef ALL_CHAR_TEST

#ifdef OVERFLOW_TEST
        duck.sendMessage("STRING 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 01234567890 \n");
        duck.sendMessage("ENTER\n");
#endif // ifdef OVERFLOW_TEST

#ifdef CLOSE_NOTEPAD
        duck.sendMessage("DELAY 5000\n");
        duck.sendMessage("ALT F4\n");
        duck.sendMessage("RIGHT\n");
        duck.sendMessage("ENTER\n");
#endif // ifdef CLOSE_NOTEPAD
    } else {
        Serial.println("Connection error");
    }
}

void loop() {}